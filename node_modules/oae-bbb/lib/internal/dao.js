Cassandra = require ('oae-util/lib/cassandra');


var createMeeting = exports.createMeeting = function (displayName, description,welcomeMessage,callback){

	var query = 'INSERT INTO Meeting (id, description, displayName, welcomeMessage) VALUES ( ?, ?, ?, ?);';
	var num = Math.round(new Date().getTime()/1000);
	var id = "m:oae:"+num.toString();
	var params = [id, description, displayName, welcomeMessage];

	Cassandra.runQuery (query,params,function(err){
		if(err){
			return callback(err);
		}
		return callback(null);
	});

};

var getMeetings = exports.getMeetings = function (callback){
	var query = 'SELECT * FROM Meeting;';
	Cassandra.runQuery (query, null, function(err,data){
		if(err){
			return callback(err);
		}
		
		return callback (null,data);
	});
};