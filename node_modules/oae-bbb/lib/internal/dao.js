Cassandra = require ('oae-util/lib/cassandra');


var createMeeting = exports.createMeeting = function (id, displayName, description,welcomeMessage, visibility, callback){

	var query = 'INSERT INTO Meeting (id, description, displayName, welcomeMessage, password, visibility) VALUES ( ?, ?, ?, ?, ?, ?);';
	var pass= id.substr(id.length - 4);
	var params = [id, description, displayName, welcomeMessage, pass, visibility];

	Cassandra.runQuery (query,params,function(err){
		if(err){
			return callback(err);
		}
		return callback(null);
	});

};

var getMeetings = exports.getMeetings = function (callback){
	var query = 'SELECT * FROM Meeting;';
	Cassandra.runQuery (query, null, function(err,data){
		if(err){
			return callback(err);
		}
		
		return callback (null,data);
	});
};

var getPass = exports.getPass = function (meetingID, callback){

	var query = "SELECT password FROM Meeting WHERE id = '" + meetingID + "';";
	Cassandra.runQuery (query, null, function(err,pass){
		if(err){
			
			return callback(err);
		}
		
		return callback (null,pass);
	});
};

var getMeetingWithID = exports.getMeetingWithID = function (meetingID, callback){
	console.log("p1",meetingID);
	var query = "SELECT * FROM Meeting WHERE id = '" + meetingID + "';";
	Cassandra.runQuery (query, null, function(err,meeting){
		if(err){
			return callback(err);
		}
		console.log("p2",meeting);		
		return callback (null,meeting);
	});
};