var sha1 = require('sha1');
var http = require('http');
var xml2js = require('xml2js');

var createBBBCall = exports.createBBBCall = function (meetingID,callback){
		
	var server = "http://192.168.1.104/";
	var secret= "66b7d7fb3d639fd6d0f7cfbe216b8727";
	var params = "meetingID=" + meetingID ;
	var checksum = sha1("create"+ params +secret);
	var url = server + "bigbluebutton/api/create?" + params + "&checksum=" + checksum;
	var parser = new xml2js.Parser();
	console.log(url);
	http.request(url, function(res) {
  		res.setEncoding('utf8');
 	 	res.on('data', function (chunk) {
			console.log(chunk);
  			parser.parseString(chunk, function(err, result){
				console.log(result['response']['returncode']);			
			
			});
		});
	}).end();
};
